<!DOCTYPE html>
<style>
    html {
        height: 100vh;
    }
    body {
        min-height: 100vh;
        display: grid;
        grid-template-rows: 1fr auto;
    }
    .footer {
        grid-row-start: 2;
        grid-row-end: 3;
    }
</style>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Hugo Sibony</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="description" property="og:description" content="Portfolio of Hugo Sibony">
  <meta name="image" property="og:image" content="/">
  <meta name="author" content="Hugo Sibony">
  <meta name="generator" content="Hugo 0.92.2" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/css/uikit.min.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="/css/style.min.css" integrity="" media="screen">
  
  <link rel="stylesheet" href="/css/syntax.min.css" integrity="" media="screen">

  <script src="https://cdn.jsdelivr.net/npm/mailgo@0.9.14/dist/mailgo.min.js" defer></script>

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

</head>
<body class="writeups">
    <div class="wrapper"><div uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky; bottom: #transparent-sticky-navbar">
    <nav class="uk-navbar-container uk-margin" uk-navbar="mode: click;" style="padding-right: 3rem">
        <div class="uk-navbar-right">
            <ul class="uk-navbar-nav uk-visible@s">
                
                
                <li><a style="font-size: 18px; text-transform: none" href="/"> Home
                        </a></li>

                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 18px; text-transform: none" href="/about">About</a></li>
                
                
                
                
                
                
                
                
                
                <li><a style="font-size: 18px; text-transform: none" href="/portfolio">Portfolio</a></li>
                
                
                
                
                
                
                
                
                
                <li class="uk-active"><a style="font-size: 18px; text-transform:none"
                        href="/writeups">Writeups</a></li>
                
                
            </ul>

            <a class="uk-navbar-toggle uk-hidden@s" uk-toggle="target: #sidenav" uk-navbar-toggle-icon href="#"></a>

        </div>
    </nav>
</div>

<div id="sidenav" uk-offcanvas="overlay: true">
    <div class="uk-offcanvas-bar uk-flex uk-flex-column">

        <ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical">
            
            <li><a style="font-size: 18px" href="https://www.hugosibony.com"> Home </a></li>

            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 18px" href="/about">About</a></li>
            
            
            
            
            
            
            
            
            
            <li><a style="font-size: 18px" href="/portfolio">Portfolio</a></li>
            
            
            
            
            
            
            
            
            
            <li class="uk-active"><a style="font-size: 18px" href="/writeups">Writeups</a></li>
            
            
        </ul>

    </div>
</div>




<style>
  p {
    margin: 0
  }

  .people-wrap {
    display: inline-flex;
    margin-top: 10px;
  }

  .people-image {
    display: block;
    border-radius: 50%;
     
  }

  .people {
    margin-left: 20px;
    margin-right: 20px;
  }

  .name {
    margin: auto;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: #000;
    font-family: Roboto, sans-serif;
    line-height: 1.2;
    margin-top: 2rem;
  }

  .content img {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    display: block;
    margin-left: auto;
    margin-right: auto;
    margin-bottom:30px;
  }

  p { margin-bottom: 1em; }

  body p:last-child { margin-bottom: 0em; }

  img.skills{
    height: 80px;
  }

  @media only screen and (min-width: 960px) {
    .content img{max-width:60vw; max-height:60vh}

  .content img{
      max-width:60vw;
      max-height:60vh
  }
  }
  .content{
      width: 90vw;
      max-width: 1200px
  }

  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }

  td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }

</style>


<section>
  <div class="uk-container uk-margin-large-bottom uk-margin-medium-top">
    <h1 class="uk-text-center uk-heading-medium">Stage 03</h1>
    <p class="uk-text-center uk-text-lead"></p>
    <p class="uk-text-center">Published on Oct 28, 2023</p>
    <p class="uk-text-center">Reading time: 3 minutes.</p>
    

    <hr class="full-width">
    

    <div class="content">
      <h2 id="stage03">Stage03</h2>
<p>After the validation, we received the following message:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ validate part1 IamAnHacker!
Ok ok... I don<span style="color:#4070a0">&#39;t understand what&#39;</span>s going on.
Your IP doesn<span style="">&#39;</span>t seem to be legitimate, and yet you are validating all accesses <span style="color:#007020;font-weight:bold">for</span> the moment...

Please logon : https://ctf.unit41.fr/logon
</code></pre></div><p><img src="/writeups/OrangeCTF-2023/Files/Untitled%202.png" alt="Untitled"></p>
<p>We need a password. Let&rsquo;s check the source code for any useful information:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#062873;font-weight:bold">div</span> <span style="color:#4070a0">style</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;text-align:center;margin-top:100px;&#39;</span>&gt;
    &lt;<span style="color:#062873;font-weight:bold">b</span>&gt;You need to enter the valid password to access to this private area. &lt;/<span style="color:#062873;font-weight:bold">b</span>&gt;&lt;<span style="color:#062873;font-weight:bold">br</span> /&gt;&lt;<span style="color:#062873;font-weight:bold">br</span> /&gt;

    Password : &lt;<span style="color:#062873;font-weight:bold">input</span> <span style="color:#4070a0">type</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;password&#34;</span> <span style="color:#4070a0">value</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;&#34;</span> <span style="color:#4070a0">id</span><span style="color:#666">=</span><span style="color:#4070a0">&#39;password&#39;</span>&gt;&lt;<span style="color:#062873;font-weight:bold">br</span> /&gt;&lt;<span style="color:#062873;font-weight:bold">br</span> /&gt;
    &lt;<span style="color:#062873;font-weight:bold">input</span> <span style="color:#4070a0">type</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;button&#34;</span> <span style="color:#4070a0">onclick</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;Validate()&#34;</span> <span style="color:#4070a0">value</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;Connect&#34;</span>&gt;
    &lt;<span style="color:#062873;font-weight:bold">br</span> /&gt;
&lt;/<span style="color:#062873;font-weight:bold">div</span>&gt;

&lt;<span style="color:#062873;font-weight:bold">script</span> <span style="color:#4070a0">src</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js&#34;</span>&gt;&lt;/<span style="color:#062873;font-weight:bold">script</span>&gt;
&lt;<span style="color:#062873;font-weight:bold">script</span>&gt;
    <span style="color:#007020;font-weight:bold">function</span> Validate() {
        <span style="color:#007020;font-weight:bold">const</span> map <span style="color:#666">=</span> <span style="color:#4070a0">&#34;abcdefghijklmnopqrstuvwxyz0123456789&#34;</span>;
        <span style="color:#007020;font-weight:bold">const</span> $p <span style="color:#666">=</span> $(<span style="color:#4070a0">&#39;#password&#39;</span>).val();
        <span style="color:#007020;font-weight:bold">const</span> $t <span style="color:#666">=</span> map.charAt(<span style="color:#40a070">7</span>) <span style="color:#666">+</span> map.charAt(<span style="color:#40a070">4</span>) <span style="color:#666">+</span> <span style="color:#4070a0">&#39;l&#39;</span> <span style="color:#666">+</span> map.charAt(<span style="color:#40a070">11</span>) <span style="color:#666">+</span> map.charAt(<span style="color:#40a070">26</span>);
        <span style="color:#007020;font-weight:bold">if</span> ($p <span style="color:#666">==</span> $t) {
            alert(<span style="color:#4070a0">&#34;Profil unlocked.\nPlease type this password as a secret command on your terminal...&#34;</span>);
        } <span style="color:#007020;font-weight:bold">else</span> {
            alert(<span style="color:#4070a0">&#34;This is not a valid password.&#34;</span>);
        }   
    }
&lt;/<span style="color:#062873;font-weight:bold">script</span>&gt;
</code></pre></div><p>We deciphered the code using Python:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020">map</span> <span style="color:#666">=</span> <span style="color:#4070a0">&#34;abcdefghijklmnopqrstuvwxyz0123456789&#34;</span>
password <span style="color:#666">=</span> <span style="color:#007020">map</span>[<span style="color:#40a070">7</span>] <span style="color:#666">+</span> <span style="color:#007020">map</span>[<span style="color:#40a070">4</span>] <span style="color:#666">+</span> <span style="color:#4070a0">&#39;l&#39;</span> <span style="color:#666">+</span> <span style="color:#007020">map</span>[<span style="color:#40a070">11</span>] <span style="color:#666">+</span> <span style="color:#007020">map</span>[<span style="color:#40a070">26</span>]
<span style="color:#007020">print</span>(password)

<span style="color:#666">&gt;&gt;&gt;</span> hell0
</code></pre></div><p>The password is <strong><code>hell0</code></strong>. When entered in the interface, we were asked to type it in the terminal to continue.</p>
<hr>
<p>In the terminal, we received a message:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hell0
I feel like I<span style="color:#4070a0">&#39;m in a dream... Who wakes me up? Let me sleep... Please let me sleep...!
</span><span style="color:#4070a0">Please let me sleep... Don&#39;</span>t say that to me anymore... Goodbye... Goodbye...
</code></pre></div><p>At first, it seemed like a coded message, but then I realized he asked not to repeat what we said, so obviously, I did.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hell0
LET ME SLEEP RIGHT NOW... DONT TRY AGAIN ! LAST CHANCE FOR YOU !

$ hell0
Okkkkkkkkkkk...........
I am the person in charge of the passwords of the platform.
I always try to enforce the best password complexity.

For example, the last generated one, I used the following method:

- A number representing the answer to everything,
- The name of the malware deployed via SolarWind since 2/20/2020, passed to the <span style="color:#007020;font-weight:bold">function</span> ucfirst<span style="color:#666">()</span>,
- A number representing the maximum rights on a linux file system,
- A variant of A in Leet Speak,

-&gt; Finally, concat all answers,

It seems to me that it was created <span style="color:#007020;font-weight:bold">for</span> a new top secret access...
Yes, I know where to reach it, but I can<span style="color:#4070a0">&#39;t talk about it... I&#39;</span>m bugged... And I can<span style="color:#4070a0">&#39;t say too much about it because afterwards I dream about it at night (and it seems that I talk in my sleep!! LOL).
</span><span style="color:#4070a0">
</span><span style="color:#4070a0">Go to hell, I&#39;</span>m going to sleep... ZZzzZZZzz
</code></pre></div><p>Now we’re talking !</p>
<p>After some internet research:</p>
<ol>
<li>A number representing the answer to everything → <strong><code>42</code></strong></li>
<li>The name of the malware deployed via SolarWind since 2/20/2020, passed to the function ucfirst()→ <strong>sunburst</strong> is the name of the malware and <strong>ucfirst()</strong> is a capitalize function. thus : <strong><code>Sunburst</code></strong></li>
<li>A number representing the maximum rights on a linux file system→ <strong><code>777</code></strong></li>
<li>A variant of A in Leet Speak → It could be either <strong><code>4</code></strong> or <strong><code>@</code></strong>, but they specified that it was a number for both 1) and 3), we can assume it’s <strong><code>@</code></strong></li>
</ol>
<p>Concatenated, this gives us the password : <strong><code>42Sunburst777@</code></strong></p>
<p>After an hour of trying every possible combination with other appellations of the malware (because we then assumed the password was wrong), we looked more closely at the text after the questions.</p>
<blockquote>
<p>It seems to me that it was created for a new top secret access&hellip;
Yes, I know where to reach it, but I can&rsquo;t talk about it&hellip; I&rsquo;m bugged&hellip; And I can&rsquo;t say too much about it because afterwards I dream about it at night (and it seems that I talk in my sleep!! LOL).</p>
</blockquote>
<blockquote>
<p>Go to hell, I&rsquo;m going to sleep&hellip; ZZzzZZZzz</p>
</blockquote>
<p>It seems that we needed to input this password in an interface somewhere, but where?</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ hell0
ZzzzZZZ ctf.unit41.fr/ZzzzzZZZ/ ZzzzZZZzzZZ http ZzzzZZZzzZZZ over ZZZZzzzZZZZ SSL ZzzzzZZZzzZ
</code></pre></div><p>Yeah… We were supposed to type hell0 to make him talk one last time… after punching myself in the face, I then went to the URL.</p>
<p><img src="/writeups/OrangeCTF-2023/Files/Untitled%203.png" alt="Untitled"></p>
<p>We have an interface! So we typed our guessed password:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">// Under Maintenance //

// Todo list :
- Create the form to validate the part 2 if terminal is down
- Give access to all internet of things
- Permit to reboot every root routers

// Use the terminal while this page is being updated
Part Code = part42
Part Password = WeAreNotAlone

But do you remember the syntax command to validate?
</code></pre></div><p>Flag acquired! The syntax is <code>validate part42 WeAreNotAlone</code></p>

    </div>
  </div>
  </div>
</section>



    </div>
<footer class="footer">
  <div class="uk-container">

    <div class="uk-grid-small uk-child-width-1-4@m uk-text-center uk-flex-center uk-margin-medium-bottom" uk-grid>
      <div class="uk-margin-small-bottom">
        <h5 class="uk-margin-small-bottom">Email</h5>
        <a href="mailto:hugo@hugosibony.com">hugo@hugosibony.com</a>

      </div>
      <div>
        <h5 class="uk-margin-small-bottom">Address</h5>
          <div uk-lightbox>
            <a href="" data-caption="Paris, France"
               data-type="iframe">Paris, France</a>
          </div>
      </div>
    </div>


    <div class="footer-copyright uk-text-center" style="padding-bottom: 1rem">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" style="height: 1.2em;
  width: 1.2em;" alt="Creative Commons">
      <img loading="lazy" src="https://mirrors.creativecommons.org/presskit/icons/by.svg" style="height: 1.2em;
  width: 1.2em;" alt="CC-BY">
      2023
      Hugo Sibony
    </div>
  </div>
</footer>


<!-- JS Plugins -->

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.6/dist/js/uikit-icons.min.js"></script>

</body>
</html>
